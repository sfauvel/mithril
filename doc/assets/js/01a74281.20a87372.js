"use strict";(self.webpackChunkmithril_doc=self.webpackChunkmithril_doc||[]).push([[47],{19636:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var r=t(85893),n=t(3905);const o={title:"Mithril Keys Certification",authors:[{name:"Mithril Team"}],tags:["cardano","poolId","operational-certificate","kes-keys","mithril-keys","hybrid-mode"]},s=void 0,a={permalink:"/doc/dev-blog/2022/10/11/keys-certification-badge",source:"@site/blog/2022-10-11-keys-certification-badge/index.md",title:"Mithril Keys Certification",description:"Update 2022/12/19: The signer registration with declarative PoolId has been decommissioned.",date:"2022-10-11T00:00:00.000Z",formattedDate:"October 11, 2022",tags:[{label:"cardano",permalink:"/doc/dev-blog/tags/cardano"},{label:"poolId",permalink:"/doc/dev-blog/tags/pool-id"},{label:"operational-certificate",permalink:"/doc/dev-blog/tags/operational-certificate"},{label:"kes-keys",permalink:"/doc/dev-blog/tags/kes-keys"},{label:"mithril-keys",permalink:"/doc/dev-blog/tags/mithril-keys"},{label:"hybrid-mode",permalink:"/doc/dev-blog/tags/hybrid-mode"}],readingTime:2.39,hasTruncateMarker:!1,authors:[{name:"Mithril Team"}],frontMatter:{title:"Mithril Keys Certification",authors:[{name:"Mithril Team"}],tags:["cardano","poolId","operational-certificate","kes-keys","mithril-keys","hybrid-mode"]},unlisted:!1,prevItem:{title:"Mithril environments are updated",permalink:"/doc/dev-blog/2022/10/28/updated-environments"},nextItem:{title:"Mithril internal stores switch to SQLite.",permalink:"/doc/dev-blog/2022/09/14/sqlite-stores"}},l={authorsImageUrls:[void 0]},d=[{value:"The way the Mithril nodes handle the Certification of the SPOs is evolving",id:"the-way-the-mithril-nodes-handle-the-certification-of-the-spos-is-evolving",level:3},{value:"Upgrade a Mithril Signer running a previous version",id:"upgrade-a-mithril-signer-running-a-previous-version",level:4},{value:"Hybrid Certification mode in the Mithril network",id:"hybrid-certification-mode-in-the-mithril-network",level:4},{value:"How Keys Certification works",id:"how-keys-certification-works",level:4}];function h(e){const i={a:"a",code:"code",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.ah)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Update 2022/12/19"}),": The signer registration with ",(0,r.jsx)(i.strong,{children:"declarative"})," PoolId has been decommissioned."]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Update 2022/11/30"}),": The signer registration with ",(0,r.jsx)(i.strong,{children:"declarative"})," PoolId has been deprecated and the ",(0,r.jsx)(i.strong,{children:"certified"})," PoolId is now the stable mode."]}),"\n",(0,r.jsx)(i.h3,{id:"the-way-the-mithril-nodes-handle-the-certification-of-the-spos-is-evolving",children:"The way the Mithril nodes handle the Certification of the SPOs is evolving"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"PR"}),": ",(0,r.jsx)(i.code,{children:"New STM registration procedure"})," ",(0,r.jsx)(i.a,{href:"https://github.com/input-output-hk/mithril/pull/433",children:"#433"})]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Issues"}),": ",(0,r.jsx)(i.code,{children:"Implement Certification of the Mithril Verification Keys in Signer/Aggregator"})," ",(0,r.jsx)(i.a,{href:"https://github.com/input-output-hk/mithril/issues/455",children:"#455"})]}),"\n",(0,r.jsx)(i.p,{children:"We have released a new Mithril Signer Verification Keys Certification mechanism:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Mithril Signer nodes running the previous version are still able to interact with the network without any further intervention"}),"\n",(0,r.jsx)(i.li,{children:"Mithril Signer nodes that are updated from a previous version must migrate some of their stores"}),"\n",(0,r.jsxs)(i.li,{children:["This mechanism is ",(0,r.jsx)(i.strong,{children:"experimental"})," and can be activated on demand by the SPOs"]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"upgrade-a-mithril-signer-running-a-previous-version",children:"Upgrade a Mithril Signer running a previous version"}),"\n",(0,r.jsxs)(i.p,{children:["The SPOs need to recompile their Signer node (as in this ",(0,r.jsx)(i.a,{href:"https://mithril.network/doc/manual/getting-started/run-signer-node",children:"guide"}),")."]}),"\n",(0,r.jsx)(i.p,{children:"The data stores of the node need to be updated by running the following command:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"# The path to your data stores directory, which defaults to:\nDATA_STORES_DIRECTORY=/opt/mithril/stores\n\n# Run this command to upgrade your stores:\nsqlite3 ${DATA_STORES_DIRECTORY}/signer.sqlite3 \"UPDATE protocol_initializer SET value = json_object('stm_initializer', json(value), 'kes_signature', null) WHERE json_extract(value, '$.stm_initializer') IS NULL;\"\n"})}),"\n",(0,r.jsxs)(i.p,{children:["\u26a0\ufe0f"," If you don't update your data stores with this procedure, your node will not be able to register to the Aggregator temporarily. It should then take up to ",(0,r.jsx)(i.code,{children:"3"})," epochs before it is able to successfully register its individual signatures with the Aggregator."]}),"\n",(0,r.jsx)(i.h4,{id:"hybrid-certification-mode-in-the-mithril-network",children:"Hybrid Certification mode in the Mithril network"}),"\n",(0,r.jsx)(i.p,{children:"From now, SPOs can either run their node by:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsxs)(i.strong,{children:["Declaring their Cardano ",(0,r.jsx)(i.code,{children:"PoolId"})]}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"This is the mode that all nodes were running prior to this release"}),"\n",(0,r.jsxs)(i.li,{children:["This mode is still the ",(0,r.jsx)(i.strong,{children:"stable"})," mode"]}),"\n",(0,r.jsx)(i.li,{children:"We intend to deprecate this mode in the near future"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsxs)(i.strong,{children:["Certifying their Cardano ",(0,r.jsx)(i.code,{children:"PoolId"})]}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["The certification is done by providing the Mithril Signer node with ",(0,r.jsx)(i.code,{children:"KES Secret Key Path"})," and ",(0,r.jsx)(i.code,{children:"Operational Certificate Path"})]}),"\n",(0,r.jsxs)(i.li,{children:["This is an ",(0,r.jsx)(i.strong,{children:"experimental"})," mode"]}),"\n",(0,r.jsxs)(i.li,{children:["We intend to make this mode the only way of providing a ",(0,r.jsx)(i.code,{children:"PoolId"})," in the near future"]}),"\n",(0,r.jsxs)(i.li,{children:["These ",(0,r.jsx)(i.code,{children:"PoolIds"})," will be marked with a ",(0,r.jsx)(i.code,{children:"Verified Signer"})," green badge in the ",(0,r.jsx)(i.a,{href:"https://mithril.network/explorer/",children:"Mithril Explorer"})," (",(0,r.jsx)(i.code,{children:"2"})," epochs after activating the Certification mode)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["The setup of a Mithril Signer node with these two modes is available in this ",(0,r.jsx)(i.a,{href:"https://mithril.network/doc/manual/getting-started/run-signer-node",children:"guide"}),"."]}),"\n",(0,r.jsxs)(i.p,{children:["Here is an example of the ",(0,r.jsx)(i.code,{children:"Verified Signer"})," badge displayed in the Certificate details popin:\n",(0,r.jsx)(i.img,{alt:"Verified Signer Badge",src:t(67074).Z+"",width:"550",height:"221"})]}),"\n",(0,r.jsx)(i.h4,{id:"how-keys-certification-works",children:"How Keys Certification works"}),"\n",(0,r.jsxs)(i.p,{children:["We rely on the Cardano ",(0,r.jsx)(i.code,{children:"KES Keys"})," and ",(0,r.jsx)(i.code,{children:"Operational Certificate"})," to be able to:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["Compute automatically the ",(0,r.jsx)(i.code,{children:"PoolId"})," from a valid ",(0,r.jsx)(i.code,{children:"Operational Certificate"})]}),"\n",(0,r.jsxs)(i.li,{children:["Sign the ",(0,r.jsx)(i.code,{children:"Mithril Signer Verification Key"})," with the ",(0,r.jsx)(i.code,{children:"KES Secret Key"})]}),"\n",(0,r.jsxs)(i.li,{children:["Verify that the ",(0,r.jsx)(i.code,{children:"Mithril Signer Verification Key"})," is associated to the owner of the pool"]}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.img,{alt:"Keys Certification Schema",src:t(43757).Z+"",width:"1134",height:"881"})}),"\n",(0,r.jsxs)(i.p,{children:["Feel free to reach out to us on the ",(0,r.jsx)(i.a,{href:"https://discord.gg/5kaErDKDRq",children:"Discord channel"})," for questions and/or help."]})]})}function c(e={}){const{wrapper:i}={...(0,n.ah)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},3905:(e,i,t)=>{t.d(i,{ah:()=>d});var r=t(67294);function n(e,i,t){return i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}function o(e,i){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);i&&(r=r.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var i=1;i<arguments.length;i++){var t=null!=arguments[i]?arguments[i]:{};i%2?o(Object(t),!0).forEach((function(i){n(e,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}))}return e}function a(e,i){if(null==e)return{};var t,r,n=function(e,i){if(null==e)return{};var t,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],i.indexOf(t)>=0||(n[t]=e[t]);return n}(e,i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],i.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var l=r.createContext({}),d=function(e){var i=r.useContext(l),t=i;return e&&(t="function"==typeof e?e(i):s(s({},i),e)),t},h={inlineCode:"code",wrapper:function(e){var i=e.children;return r.createElement(r.Fragment,{},i)}},c=r.forwardRef((function(e,i){var t=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),p=d(t),g=n,u=p["".concat(l,".").concat(g)]||p[g]||h[g]||o;return t?r.createElement(u,s(s({ref:i},c),{},{components:t})):r.createElement(u,s({ref:i},c))}));c.displayName="MDXCreateElement"},67074:(e,i,t)=>{t.d(i,{Z:()=>r});const r=t.p+"assets/images/badge-d830657d3818b56eb6d9dd154085e753.png"},43757:(e,i,t)=>{t.d(i,{Z:()=>r});const r=t.p+"assets/images/schema-2bb1f4c4f967eddf4006f3acb8dbcb88.jpg"}}]);